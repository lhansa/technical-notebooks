{
  "hash": "4acf8d5125eeaacc3baef79356d8bd4b",
  "result": {
    "markdown": "---\ntitle: \"Muestreo (I)\"\ndescription: \"Un repaso a algunos conceptos introductorios al muestreo estadístico\"\ndescription-meta: \"Explicación de conceptos sobre muestreo (sampling) estadístico\"\nauthor: \"Leonardo Hansa\"\ndate: \"2023-07-18\"\ncategories: [datos]\nexecute: \n  echo: false\nfreeze: auto\n---\n\n\nVi en Twitter esto: \n\n<blockquote class=\"twitter-tweet\"><p lang=\"es\" dir=\"ltr\">Las encuestas lo han dejado claro.<br>Saben lo que vas a votar.<br>Han decidido que el <a href=\"https://twitter.com/hashtag/23J?src=hash&amp;ref_src=twsrc%5Etfw\">#23J</a> PP y Vox gobernarán este país.<br>¿Quito importancia a sus estimaciones?<br>No, porque generalizan la opinión de que no hay nada que hacer.<br>Pero no es cierto. <br>No hay nada escrito.<br>Si votamos, ganamos <a href=\"https://t.co/LUFoLm3WHT\">pic.twitter.com/LUFoLm3WHT</a></p>&mdash; Carlos Sánchez Mato🔻✳️ (@carlossmato) <a href=\"https://twitter.com/carlossmato/status/1681041667573334019?ref_src=twsrc%5Etfw\">July 17, 2023</a></blockquote> <script async src=\"https://platform.twitter.com/widgets.js\" charset=\"utf-8\"></script>\n\n¿Es inútil el muestreo? \n\nSi lo haces mal, sí. Como todo. \n\nRepaso algunos conceptos relacionados con el muestreo, sacados principalmente del curso de _Sampling with R_ de Datacamp. \n\n## De qué sirve el muestreo\n\nAntes de las elecciones se hacen encuestas sobre intención de voto. ¿Qué se te viene a la mente con estas encuestas?\n\nPues que nunca te preguntan a ti. \n\n(Sí, ya, justo quizá a ti sí, una vez... pero no suele ocurrir. Lo normal es que nunca te hayan preguntado). \n\nA la mayoría de las personas no les preguntan nada. \n\nPero un muestreo adecuado puede hacer que eso tenga valor. \n\nEs más, **un muestreo puede ser tu única opción para estudiar unos datos.**\n\n- En un caso como el de las encuestas, no tienen recursos para encuestar a todos los votantes de un país como, pongamos, España ([unos 37 millones de personas](https://www.boe.es/boe/dias/2019/12/02/pdfs/BOE-A-2019-17344.pdf))\n- En un análisis de sangre, no estudian todos los litros de sangre de tu cuerpo: te sacan una muestra y generalizan (sacarte toda la sangre es peligroso: no lo intentes). \n- Si tienes una base de datos con millones de clientes, algún algoritmo de _machine learning_ puede suponer mucha carga de trabajo para tu ordenador (no todos tenemos presupuesto para contratar servidores enormes en Amazon). )\n\n¿Tiene sentido siempre el muestreo? No. Si estás corrigiendo unos exámenes de unos alumnos, no tiene sentido que corrijas un porcentaje y extrapoles los demás por ahorrarte el tiempo. \n\n## Muestreo aleatorio sistemático\n\nSi has estudiado algo de estadística, te habrás topado con el muestreo aleatorio. Consiste en seleccionar las observaciones para una muestra sin ningún criterio en concreto: esta sí, esta no, esta sí, esta también porque sí, esta no, esta tampoco...\n\nMe gusta un [conjunto de datos con métricas de pingüinos](https://allisonhorst.github.io/palmerpenguins/) disponible en cualquier software estadístico que se precie. \n\n\n\n::: {.cell}\n::: {.cell-output-display}\n|species |island    | bill_length_mm| bill_depth_mm| flipper_length_mm| body_mass_g|sex    | year|\n|:-------|:---------|--------------:|-------------:|-----------------:|-----------:|:------|----:|\n|Adelie  |Torgersen |           39.1|          18.7|               181|        3750|male   | 2007|\n|Adelie  |Torgersen |           39.5|          17.4|               186|        3800|female | 2007|\n|Adelie  |Torgersen |           40.3|          18.0|               195|        3250|female | 2007|\n|Adelie  |Torgersen |             NA|            NA|                NA|          NA|NA     | 2007|\n|Adelie  |Torgersen |           36.7|          19.3|               193|        3450|female | 2007|\n|Adelie  |Torgersen |           39.3|          20.6|               190|        3650|male   | 2007|\n:::\n:::\n\n\nUna de las métricas que tiene es la longitud del pico, en milímetros. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/histograma1-1.png){width=672}\n:::\n:::\n\n\n¿Cómo cambia eso si lo dibujas sobre una muestra aleatoria de los pingüinos?\n\nLo primero es elegir la muestra aleatoria. Supón que etiquetas a cada uno como 1, 2, 3... así hasta 344, que son todos los pingüinos que tienes. \n\nEn el siguiente gráfico tienes coloreados en azul los pingüinos que eliges para tu muestra (50). \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n¿Cómo cambia la distribución de la longitud del pico en esta muestra? \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/hist2-1.png){width=672}\n:::\n:::\n\n\nHemos perdido valores extremos pero se mantiene una forma parecida. \n\nUn tipo diferente de muestreo es el sistemático, que consiste en hacer una selección basada en un criterio con respecto a la posición de la observación en el conjunto de datos. En el siguiente gráfico, pinto en azul al pingüino 1, 7, 13, etc... o sea, selecciono al primer pingüino de cada 6. \n\n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/samplesist-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/hist3-1.png){width=672}\n:::\n:::\n\n\nAparte del caso extremo, la distribución no ha cambiado mucho, en parte porque la distribución de las observaciones no sigue ningún orden en concreto. Si tu tabla de datos sigue un orden, deberás valorar si ese orden afecta al sistema que eliges para muestrear tus datos. \n\n\n## Muestreo estratificado\n\nEn el conjunto de datos tenemos tres especies de pingüinos. \n\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n\nAlgo habitual en _machine learning_ forzar a mantener esa proporción diferente de especies en la muestra elegida, para que el conjunto de datos de trabajo mantenga esa distribución original. \n\n¿Pero qué pasa si no quieres que así sea? \n\nImagina que estás estudiando si una medicación es efectiva o no. Si mantienes la proporción original, puede ser que de la especie menos representada (Chinstrap) te quedes casi sin muestra. \n\nEso te puede venir mal, porque tú necesitas que haya muestra de todas las especies, para saber si en una especie el medicamento es más o menos efectivo. \n\nEn un caso así, no querrías un muestreo estratificado, sino que forzarías incluso a que en la muestra, todos los grupos estuvieran igualmente representados. \n\n## Cómo afecta el tamaño de la muestra\n\nCuando tienes a mano la población total, puedes comparar los cálculos que hagas en tu muestra con los de la población (para cuando no tengas la población, te hablaré de esto en unos días). \n\nEn el caso de los pingüinos, puedo calcular la media de la longitud del pico para la población: 43.9219298. \n\nO también para la muestra que calculé antes: \n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  media_muestral\n           <dbl>\n1           44.6\n```\n:::\n:::\n\n\n¿Son muy distintas?\n\nUna medida de esta diferencia es el error relativo: \n\n$$\\frac{|media_{pop} - media_{sample}|}{media_{pop}}$$\n\n\n¿Cuál es la gracia? \n\nPues que si tu tamaño muestral es muy pequeño, no hay ninguna garantía de que la media (o lo que estés midiendo) se parezca a la poblacional:\n\n\n::: {.cell}\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 1 × 1\n  media_muestral\n           <dbl>\n1           45.8\n```\n:::\n:::\n\n\nPero si dejas que el tamaño muestral crezca, tu cálculo se estabilizará. \n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n::: {.cell-output-display}\n![](index_files/figure-html/evol-sample-error2-1.png){width=672}\n:::\n:::\n\n\n\n[En unos días](https://longitudsinanchura.com/posts/2023-07-21-muestreo-ii) te escribo sobre cómo aproximar esto cuando no tienes acceso a la media poblacional, pero que puedas valorar si tu muestra es adecuada o no.\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}