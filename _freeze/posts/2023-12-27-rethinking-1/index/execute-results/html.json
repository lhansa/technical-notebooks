{
  "hash": "75c8eedd4d91f689d98c0577c4feb5ec",
  "result": {
    "markdown": "---\ntitle: \"Statistical Rethinking (1)\"\ndescription: \"Introducción de métodos generativos en estadística bayesiana, basados en el libro Statistical Rethinking de Richard McElreath\"\ndescription-meta: \"Introducción de métodos generativos en estadística bayesiana, basados en el libro Statistical Rethinking de Richard McElreath\"\nauthor: \"Leonardo Hansa\"\ndate: \"2023-12-27\"\ncategories: [datos]\nexecute: \n  echo: true\nfreeze: auto\n---\n\n\nEn [Statistical Rethinking](https://xcelab.net/rm/statistical-rethinking/) Richard McEalreath presenta los métodos generativos en estadística bayesiana. \n\n## Introducción\n\nEl problema que plantea es el de estimar la proporción de agua que hay en la Tierra. \n\nEl procedimiento consiste en mirar en varios puntos de la Tierra y ver si hay agua o tierra. De esa forma obtienes una secuencia de valores: `\"A\", \"A\", \"T\", \"A\", \"T\", ...` y usas esos datos para estimar la proporción real. \n\nConcretamente, en 9 observaciones has obtenido 6 porciones de agua.\n\nHay tres formas de ajustar un modelo estadístico. Las ejemplificaremos con ese problema de la proporción de agua. \n\nLos códigos serán los del libro.\n\n\n## Mallado\n\nLa primera forma de ajustar un modelo estadístico es mediante mallado. Computacionalmente es costoso pero es más educativo que el resto de métodos. \n\nLo que vas a hacer es proponer unos posibles valores para el parámetro que buscas (la proporción de agua) y les das una distribución a priori a estos valores (no pasa nada ahora por que la distribución a priori no sume 1 porque luego estandarizarás el resultado final).  \n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngrid_size <- 20\n# define grid\np_grid <- seq(from = 0, to = 1, length.out = grid_size)\n# define prior\nprior <- rep(1 , grid_size)\n```\n:::\n\n\nTus priori (20 proporciones equiprobables) ya están definidas y ahora te sirven para generar posibles escenarios. La idea es ver la verosimilitud de tus datos observados ante los distintos posibles valores del parámetro. \n\n\n::: {.cell}\n\n```{.r .cell-code}\nlikelihood <- dbinom(6, size = 9, prob = p_grid)\nlikelihood\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 0.000000e+00 1.518149e-06 8.185093e-05 7.772923e-04 3.598575e-03\n [6] 1.116095e-02 2.668299e-02 5.292110e-02 9.082698e-02 1.383413e-01\n[11] 1.897686e-01 2.361147e-01 2.666113e-01 2.714006e-01 2.450051e-01\n[16] 1.897686e-01 1.179181e-01 5.026670e-02 8.853845e-03 0.000000e+00\n```\n:::\n:::\n\n\nAhora calculas la posteriori, ponderando estas verosimilitudes por los prioris que tenías antes. Como los prioris no seguían una distribución de probabilidad, te toca estandarizar el resultado.\n\n\n::: {.cell}\n\n```{.r .cell-code}\nunstd_posterior <- likelihood * prior\nposterior <- unstd_posterior / sum(unstd_posterior)\nposterior\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n [1] 0.000000e+00 7.989837e-07 4.307717e-05 4.090797e-04 1.893887e-03\n [6] 5.873873e-03 1.404294e-02 2.785174e-02 4.780115e-02 7.280739e-02\n[11] 9.987296e-02 1.242643e-01 1.403143e-01 1.428349e-01 1.289433e-01\n[16] 9.987296e-02 6.205890e-02 2.645477e-02 4.659673e-03 0.000000e+00\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot(p_grid, posterior, type = \"b\",\n     xlab = \"Probabidad de agua\" , \n     ylab = \"Posteriori\")\nmtext(\"20 puntos\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/mallado-plot-1.png){width=672}\n:::\n:::\n\n\nAhora bien, ten en cuenta que **los prioris forman parte del modelo**. Deberías tener un criterio para elegir unos u otros. \n\nLos puedes cambiar y los resultados se verán afectados. \n\n\n::: {.cell}\n\n```{.r .cell-code}\np_grid <- seq(0, 1, length.out = grid_size)\nprior <- exp(-5 * abs(p_grid - 0.5))\n\nlikelihood = dbinom(6, 9, prob = p_grid)\n\nunstd_posterior <-  likelihood * prior\nposterior <- unstd_posterior / sum(unstd_posterior)\n\nplot(p_grid, posterior, type = \"b\",\n     xlab = \"Probabidad de agua\" , \n     ylab = \"Posteriori\")\nmtext(sprintf(\"%i puntos\", grid_size))\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}